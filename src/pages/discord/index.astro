---
import "../../css/discordlabo.scss";
import Layout from "../../layouts/Layout.astro";
import Nav from "../../components/Nav.astro";
import { getCategorys, getDiscordPosts } from "../../libs/microcms";

//microCMSã®ã‚«ãƒ†ã‚´ãƒªãƒ¼æƒ…å ±ã‚’å–å¾—ã™ã‚‹
const category_microcms = await getCategorys();
//microCMSã®POSTæƒ…å ±ã‚’å–å¾—ã™ã‚‹
const response = await getDiscordPosts();
---

<Layout title="1989." category_microcms={category_microcms} response={response} path="" Is_nav={true} >
  <main>
    <div class="wrapper">
      <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¸€è¦§ãƒªã‚¹ãƒˆï¼ˆã‚µã‚¤ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰ -->
      <aside class="contents-block">
        <ul class="contents-block__lists">
          {
            /*ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ç¹°ã‚Šè¿”ã—*/
            category_microcms.contents.map((category: any) => (
              <li class="contents-block__list">
                <a href={"/" + category.id} class="focus contents-block__category">
                  {category.category}
                </a>
              </li>
            ))
          }
        </ul>
      </aside>
      <!-- æŠ•ç¨¿è¨˜äº‹ã‚¨ãƒªã‚¢ -->
      <article class="discord-block">
        <!-- <h2 class="discord-title">Discord Labo</h2> -->
        <p class="discord__labocategory">ğŸš€ALL(å…¨è¨˜äº‹)</p>
        <div class="discord-posts">
          {
            /*æŠ•ç¨¿è¨˜äº‹ã”ã¨ã®ç¹°ã‚Šè¿”ã—å‡¦ç† */
            response.contents.map(
              (detailPost: any) =>

                  <a href={detailPost.category.id + "/" + detailPost.id} class="post">
                    <img
                      src={detailPost.thumbnail.url}
                      alt=""
                      class="post-img"
                    />
                    <div class="post__detail">
                      <h3 class="post__title">{detailPost.title}</h3>
                      <div class="post__time">
                        <p class="post__createtime">
                          {detailPost.createdAt.substring(0, 10)} ä½œæˆ
                        </p>
                        <p class="post__updatetime">
                          {detailPost.updatedAt.substring(0, 10)} æ›´æ–°
                        </p>
                      </div>
                      <p class="post__category">{detailPost.category.category}</p>
                    </div>
                  </a>

                // //é¸æŠã—ãŸã‚«ãƒ†ã‚´ãƒªã¨ä¸€è‡´ã™ã‚‹è¨˜äº‹ã®ã¿è¡¨ç¤ºã™ã‚‹
                // detailPost.category.id === categories && (
                //   <a href={categories + "/" + detailPost.id} class="post">
                //     <img
                //       src={detailPost.thumbnail.url}
                //       alt=""
                //       class="post-img"
                //     />
                //     <div class="post__detail">
                //       <h3 class="post__title">{detailPost.title}</h3>
                //       <div class="post__time">
                //         <p class="post__createtime">
                //           {detailPost.createdAt.substring(0, 10)} ä½œæˆ
                //         </p>
                //         <p class="post__updatetime">
                //           {detailPost.updatedAt.substring(0, 10)} æ›´æ–°
                //         </p>
                //       </div>
                //     </div>
                //   </a>
                // )
            )
          }
        </div>
      </article>
    </div>
  </main>
</Layout>
